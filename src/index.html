<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <style>
        #app {
            position: absolute;
            top: 100px;
            right: 50px;
            bottom: 20px;
            left: 80px;

            background-color: azure;
        }

        #el_1 {

            position: absolute;
            left: 200px;
            top: 200px;
        }

        .callout-body {
            padding: 12px;
        }

    </style>
    <link rel="stylesheet" type="text/css" href="../dist/archer.callouts.css">
</head>
<body>
<div id="app">
    <button onclick="toggleCallout()">on/off</button>
    <span id="el_1">hello</span>
</div>

<script type="text/javascript" src="../dist/archer.callouts.js"></script>
<script type="text/javascript">

    var callout;
    var targetEl = document.getElementById('el_1');
    var container = document.getElementById('app');

    var onMouseDown = function(evt) {

        var containerBounds = container.getBoundingClientRect();

        console.log(containerBounds);


        var dragStart = {
            x: evt.clientX - containerBounds.left,
            y: evt.clientY - containerBounds.top
        };

        var elDragStartPos =  {
            x: targetEl.getBoundingClientRect().left - containerBounds.left,
            y: targetEl.getBoundingClientRect().top - containerBounds.top
        };



        var onMouseMove = function(evt) {

            var delta = {
                x: evt.clientX - containerBounds.left - dragStart.x,
                y: evt.clientY - containerBounds.top - dragStart.y
            };

            targetEl.style.left = (elDragStartPos.x + delta.x) + 'px';
            targetEl.style.top = (elDragStartPos.y + delta.y) + 'px';

            callout.updatePosition();
        };

        var onMouseUp = function (evt) {

            document.body.removeEventListener('mousemove', onMouseMove);
            document.body.removeEventListener('mouseup', onMouseUp);
        };

        document.body.addEventListener('mousemove', onMouseMove);

        document.body.addEventListener('mouseup', onMouseUp);
    };

    targetEl.addEventListener('mousedown', onMouseDown);


    function toggleCallout() {

        if( !callout.visible) {
            callout.show();
            callout.updatePosition();
        } else {
            callout.hide();
        }


    }

    window.onload = function (e) {

        var calloutManager = new ArcherCallouts.CalloutManager();

        //var cl = new ArcherCallouts.Callout();
        callout = calloutManager.create(document.getElementById('app'));
        callout.bind(targetEl);

        var section = callout.sections[0];
        section.content = '<div class="callout-body">hello</div>';

        callout.show();
        callout.updatePosition();

    };
</script>
</body>
</html>